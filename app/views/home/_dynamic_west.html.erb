<script type="text/javascript">
    //<![CDATA[
    if($(".navbar").width() > 767) {
        $("#zoom_img_w").elevateZoom({ 
            zoomWindowPosition: 1,
            zoomWindowOffetx: -250,
            zoomWindowFadeIn: 500,
            zoomWindowFadeOut: 500,
            zoomWindowWidth: 250, 
            zoomWindowHeight: 250,
        });
    }
    
    function SearchWest(dropID, imageID, containerID, method, url) {
        var obj = this;
        this.dropMenu = document.getElementById(dropID);
        this.image = document.getElementById(imageID);
        this.container = document.getElementById(containerID);
        this.method = method;
        this.url = url;
        
        this.dropMenu.onchange = function(event) {
            obj.chosenText = obj.dropMenu.options[obj.dropMenu.selectedIndex].text;
            obj.performSearch(event);
        }
    }

    SearchWest.prototype.performSearch = function(event) {
        var obj = this;
        var myXHR = new XMLHttpRequest();

        myXHR.onreadystatechange = function() {
            if(this.readyState === 1) {
                NProgress.start(); 
            }
            if(this.readyState === 4) {
                obj.container.removeChild(obj.image);
                obj.createImage(this.responseText);
                var newImageWest = document.getElementById("zoom_img_w");
                newImageWest.onload = function(event) {
                    NProgress.done();  
                }
                obj.image = newImageWest;
                if($(".navbar").width() > 767) {
                    $("#zoom_img_w").elevateZoom({ 
                        zoomWindowPosition: 1,
                        zoomWindowOffetx: -250,
                        zoomWindowFadeIn: 500,
                        zoomWindowFadeOut: 500,
                        zoomWindowWidth: 250, 
                        zoomWindowHeight: 250,
                    });
                }
                return;
            }
            if(this.status != 200) {
                return;
            }
        }
        myXHR.open(obj.method, obj.url+encodeURIComponent(obj.chosenText), true);
        myXHR.send();
    }
    
    SearchWest.prototype.createImage = function(path) {
        var obj = this;
        var teamPath = document.createElement("img");
        teamPath.id = "zoom_img_w";
        teamPath.className = "zoom";
        teamPath.setAttribute('src', path);
        obj.container.appendChild(teamPath);   
    }
    var sw = new SearchWest("drop_w", "zoom_img_w", "test-container_w", "GET", "/home/switch?query=");
    //]]>
</script>